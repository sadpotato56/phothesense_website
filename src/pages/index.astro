---
import Layout from '../layouts/Layout.astro';
import '../styles/index.css';
---


<Layout title="PhotheSense - Hanoi Niche Experience" headerType="hero">

    <!-- Hero Content -->
<main>
  <section class="hero-header-main">
  <div class="hero-content text-center">
    <h1>Hanoi Niche Experience</h1>
    <p>Explore Beyond - Discover Hanoi in every Sense</p>
    <a href="/experience" class="explore-btn">BEGIN YOUR JOURNEY</a>
    </div>
    <div class="swipe-up-indicator">
  <span>Swipe Up</span>
  <div class="arrow"></div>
</div>
  </section>

    <!-- =========================================================
       (E) TRUST & VALUE PROPS
       ========================================================= -->
      <!-- Trust section (white background) -->
        <section class="trust-section">
            <div class="confidence-bar">
              <div class="confidence-inner">
                
                <div class="confidence-right">
                  <p class="confidence-text">
                    Our carefully crafted itineraries collaborate with passionate<strong> Hanoians experts, thinkers, and storytellers</strong> who transform each walk into a deeper understanding of the city they call 
                    <strong>home</strong>.
                    <a class="confidence-link" href="#our-people">Meet Our People →</a>
                  </p>
                </div>
              </div>
            </div>
            
            <div class="featured-in">
              <span class="featured-in-label">Featured in:</span>
              <div class="featured-in-logos">
                
                <a href="https://www.airbnb.com/users/profile/1463939594268848159?previous_page_name=PdpExperience" target="_blank" rel="noopener noreferrer">
                  <img src="/picture/partner_logo/Airbnb_Logo.png" alt="Airbnb" loading="lazy">
                </a>

                <a href="https://www.getyourguide.com/phothesoul-s609780/" target="_blank" rel="noopener noreferrer">
                  <img src="/picture/partner_logo/GYG_logo.png" alt="GetYourGuide" loading="lazy">
                </a>

                <a href="https://www.viator.com/tours/Hanoi/Knife-Making-Workshop-in-Hanois-Blacksmith-Village/d351-5541464P2" target="_blank" rel="noopener noreferrer">
                  <img src="/picture/partner_logo/Viator_Logo.png" alt="Viator" loading="lazy" style="width: 100px; height: auto;">
                </a>

                <a href="https://www.booking.com/attractions/vn/pr39rmrqawcm-master-the-art-of-vietnamese-coffee-hanoi-brewmaster-workshop.vi.html?selected_currency=VND&source=searchresults-product-card&aid=356980&label=mkt123sc-dc1c5fa9-ba90-4001-896f-3f57b5935486&ufi=-3714993" target="_blank" rel="noopener noreferrer">
                  <img src="/picture/partner_logo/Booking_com_logo.png" alt="Booking.com" loading="lazy">
                </a>

                <a href="https://www.tripadvisor.com/Attraction_Review-g293924-d32709948-Reviews-Photheculture-Hanoi.html" target="_blank" rel="noopener noreferrer">
                  <img src="/picture/partner_logo/TripAdvisor_logo.png" alt="TripAdvisor" loading="lazy">
                </a>

              </div>
            </div>
          <!-- 3-value pill (floating white) -->
        <div class="value-pill">
                <div class="value-pill-inner">
                  <div class="value-item">
                    <h3 class="value-title">Personalized Service</h3>
                    <p class="value-text">Small groups or private options — shaped around your pace.</p>
                  </div>
                  <div class="value-divider" aria-hidden="true"></div>
                  <div class="value-item">
                    <h3 class="value-title">5000+ Testimonials</h3>
                    <p class="value-text">
                      Honest feedback from curious travelers.
                      <a class="value-link" href="https://www.tripadvisor.com/Attraction_Review-g293924-d32709948-Reviews-Photheculture-Hanoi.html">Read reviews</a>
                    </p>
                  </div>
                  <div class="value-divider" aria-hidden="true"></div>
                  <div class="value-item">
                    <h3 class="value-title">Handpicked Experiences</h3>
                    <p class="value-text">Local hosts, real stories — no copy-paste itineraries.</p>
                  </div>
                </div>
              </div>


  <!-- =========================================================
       (F) FEATURED EXPERIENCES (Mosaic layout)
       ========================================================= -->
<section class="featured-section">
  <div class="container">
    <div class="featured-mosaic">

      <!-- Large card -->
      <a href="/experience" class="featured-card featured-card--large card--text-top">
        <div class="featured-media" style="background-image:url('/picture/hanoi/hanoi.jpg');" role="img"
          aria-label="Featured experience in Hanoi"></div>

        <div class="featured-overlay">
          <div class="featured-content">
          <div class="featured-meta">
            <span class="featured-pill">Half day</span>
            <span class="featured-price">From $39</span>
          </div>
          <h3 class="featured-title">HANOI STREET STORIES</h3>
          <p class="featured-subtitle">Meet locals • Taste everyday Vietnam • Walk beyond the guidebook</p>
        </div>
        </div>
      </a>

      <!-- Small card 1 -->
      <a href="/experience" class="featured-card featured-card--small card--text-top">
        <div class="featured-media" style="background-image:url('/picture/ninhbinh/ninhbinh.jpg');" role="img"
          aria-label="Featured experience in Ninh Binh"></div>
        <div class="featured-overlay">
          <div class="featured-content">
          <div class="featured-meta">
            <span class="featured-pill">1 day</span>
            <span class="featured-price">From $49</span>
          </div>
          <h3 class="featured-title">NINH BINH SLOW ESCAPE</h3>
          <p class="featured-subtitle">Rivers • Limestone views • Quiet local rhythms</p>
          </div>
        </div>
      </a>

      <!-- Small card 2 -->
      <a href="/experience" class="featured-card featured-card--small card--text-top">
        <div class="featured-media" style="background-image:url('/picture/sapa/sapa.jpg');" role="img"
          aria-label="Featured experience in Sapa"></div>
        <div class="featured-overlay">
          <div class="featured-content">
          <div class="featured-meta">
            <span class="featured-pill">2 days</span>
            <span class="featured-price">From $69</span>
          </div>
          <h3 class="featured-title">SAPA HOME STORIES</h3>
          <p class="featured-subtitle">Village paths • Family meals • Mountain mornings</p>
          </div>
        </div>
      </a>

      <!-- Small card 1: Knife Workshop -->
      <a href="/experience/knife-workshop"
         class="featured-card featured-card--small card--text-bottom">

        <div class="featured-media"
             style="background-image:url('/picture/knife_workshop/Hanoi_KnifeMaking_Workshop_12.jpg');"
             role="img"
             aria-label="Traditional knife forging workshop">
        </div>

        <div class="featured-overlay">
          <div class="featured-content">
            <div class="featured-meta">
              <span class="featured-pill">2-3 hours</span>
              <span class="featured-price">From $42</span>
            </div>
            <h3 class="featured-title">KNIFE WORKSHOP</h3>
            <p class="featured-subtitle">
              Forge steel • Work with artisans • Take home your blade
            </p>
          </div>
        </div>
      </a>

      <!-- Small card 2: Village Tour -->
      <a href="/experience/banhmi-tour"
         class="featured-card featured-card--small card--text-bottom">

        <div class="featured-media"
             style="background-image:url('/picture/banhmi_tour/hanoi-banh-mi-tour-6.jpg');"
             role="img"
             aria-label="Rural village tour with local families">
        </div>

        <div class="featured-overlay">
          <div class="featured-content">
            <div class="featured-meta">
              <span class="featured-pill">3-4 hours</span>
              <span class="featured-price">From $29</span>
            </div>
            <h3 class="featured-title">Banh Mi TOUR</h3>
            <p class="featured-subtitle">
               Street bakeries • Crisp baguettes • Local routines
            </p>
          </div>
        </div>
      </a>

      <!-- Large card: Coffee Workshop -->
      <a href="/experience/coffee-workshop"
         class="featured-card featured-card--large card--text-bottom">

        <div class="featured-media"
             style="background-image:url('/picture/coffee_workshop/hidden-ha-noi-coffee-workshop-25.jpg');
                    background-position: bottom;"
             role="img"
             aria-label="Vietnamese coffee workshop experience">
        </div>

        <div class="featured-overlay">
          <div class="featured-content">
            <div class="featured-meta">
              <span class="featured-pill">2–3 hours</span>
              <span class="featured-price">From $19</span>
            </div>
            <h3 class="featured-title">COFFEE WORKSHOP</h3>
            <p class="featured-subtitle">
              Brew styles • Local beans • Stories behind every cup
            </p>
          </div>
        </div>
      </a>

    </div>

    <!-- Explore more experiences (Cal.com trigger) -->
    <div class="text-center mt-5">
      <a
        href="product.html"
        class="explore-btn" >
        EXPLORE MORE EXPERIENCES
      </a>
    </div>

  </div>
</section>

<!-- =========================================================
     (F2) OUR PEOPLE (A/2/i)
     A: media height scales with viewport (vh)
     2: list fits content (no scroll)
     i: default active person; bio hidden unless active/hover
========================================================= -->
<section class="our-people" id="our-people">
  <div class="container">
    
    <div class="text-center our-people__head">
      <h2 class="our-people__title">Meet Our People</h2>
      <p class="our-people__subtitle">
        Meet the team behind each experience — guides, hosts, and makers who bring Hanoi to life.
      </p>
    </div>

    <div class="our-people__split" data-our-people>
      
      <div class="our-people__media" aria-hidden="true">
        <img class="our-people__img is-active" data-person="p1" src="/picture/Our_people/OPP_01.jpg" alt="Ms. Tuyến" loading="lazy">
        <img class="our-people__img" data-person="p2" src="/picture/Our_people/OPP_04.png" alt="Mr. Chiến" loading="lazy">
        <img class="our-people__img" data-person="p3" src="/picture/Our_people/OPP_05.jpg" alt="Ms. Lý" loading="lazy">
        <img class="our-people__img" data-person="p4" src="/picture/Our_people/OPP_03.jpg" alt="Ms. Ngọc" loading="lazy">
      </div>

      <div class="our-people__panel">
        
        <div class="our-people__list">

          <div class="our-people__group is-active" data-person="p1">
            <button class="our-people__item" type="button">
              <span class="our-people__name">Ms. Tuyến</span>
              <span class="our-people__chev">›</span>
            </button>
            <div class="our-people__accordion-content">
              <div class="bio-source">
                <div class="bio-meta">Craft Host • Workshops & makers</div>
                <h3 class="bio-name">Đỗ Thị Tuyến</h3>
                <p class="bio-desc">Ms. Do Thi Tuyen began forging knives at 14, following a family tradition that shaped her life. Now in her 60s, she is the only female master blacksmith in her village, known for custom chef knives and her warm, hands-on guidance throughout every step of the workshop.</p>
                <div class="bio-cta"><a href="product.html" class="explore-btn">Explore experiences</a></div>
              </div>
            </div>
          </div>

          <div class="our-people__group" data-person="p2">
            <button class="our-people__item" type="button">
              <span class="our-people__name">Mr. Chiến</span>
              <span class="our-people__chev">›</span>
            </button>
            <div class="our-people__accordion-content">
              <div class="bio-source">
                <div class="bio-meta">Craft Designer • A Witness to History</div>
                <h3 class="bio-name">Đỗ Thanh Chiến</h3>
                <p class="bio-desc">Biological brother to Ms. Tuyen and a celebrated artisan in his own right. Mr. Chien is famous for 'dao bổ sắt'—a complex technique that fuses a razor-sharp high-carbon edge with a flexible soft steel spine. With exacting standards for export-quality blades, he is the master of precision you want by your side when forging a truly professional tool.</p>
                <div class="bio-cta"><a href="product.html" class="explore-btn">Explore experiences</a></div>
              </div>
            </div>
          </div>

          <div class="our-people__group" data-person="p3">
            <button class="our-people__item" type="button">
              <span class="our-people__name">Ms. Lý</span>
              <span class="our-people__chev">›</span>
            </button>
            <div class="our-people__accordion-content">
              <div class="bio-source">
                <div class="bio-meta">Food Storyteller • Markets & street eats</div>
                <h3 class="bio-name">Ngô Thị Hải Lý</h3>
                <p class="bio-desc">Lý specialty is food culture — not just what to eat, but why it matters. Markets, street stalls, and the stories behind each flavor.</p>
                <div class="bio-cta"><a href="product.html" class="explore-btn">Explore experiences</a></div>
              </div>
            </div>
          </div>

          <div class="our-people__group" data-person="p4">
            <button class="our-people__item" type="button">
              <span class="our-people__name">Ms. Ngọc</span>
              <span class="our-people__chev">›</span>
            </button>
            <div class="our-people__accordion-content">
              <div class="bio-source">
                <div class="bio-meta">Local Guide • Old Quarter stories</div>
                <h3 class="bio-name">Phạm Minh Ngọc</h3>
                <p class="bio-desc">Ngọc works with local artisans and workshops. Expect hands-on making, slow learning, and real conversations with people who keep traditions alive.</p>
                <div class="bio-cta"><a href="product.html" class="explore-btn">Explore experiences</a></div>
              </div>
            </div>
          </div>

        </div> 
        
        <div class="our-people__bio" aria-live="polite" id="our-people-bio-panel">
          <div class="our-people__bioInner">
            <div class="our-people__bioMeta" id="ourPeopleRole"></div>
            <h3 class="our-people__bioName" id="ourPeopleName"></h3>
            <p class="our-people__bioText" id="ourPeopleBio"></p>

            <div class="our-people__cta">
              <a href="product.html" class="explore-btn our-people__btn">Explore experiences</a>
            </div>
          </div>
        </div>

      </div> </div> </div> </section>

      </div>
    </div>
  </div>
</section>

<!-- =========================================================
     (G) SOCIAL PROOF — REVIEW WALL (masonry + lightbox)
     ========================================================= -->
<section class="review-proof">
  <div class="container">
    <div class="review-proof__head text-center">
      <h2 class="review-proof__title">What travelers say</h2>
      <p class="review-proof__sub">
        Real screenshots from guests — proof you can feel, not just read.
      </p>
    </div>

    <div class="review-proof__foot text-center">
      <span class="review-proof__hint">Tap any screenshot to zoom</span>
    </div>

    <!-- Desktop: masonry | Mobile: horizontal swipe -->
    <div class="review-wall" aria-label="Guest review screenshots">

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-03.jpg" aria-label="Open review 1">
    <img src="/picture/testimonial/tsm-03.jpg" alt="Guest testimonial screenshot 3" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-02.jpg" aria-label="Open review 2">
    <img src="/picture/testimonial/tsm-02.jpg" alt="Guest testimonial screenshot 2" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-01.jpg" aria-label="Open review 3">
    <img src="/picture/testimonial/tsm-01.jpg" alt="Guest testimonial screenshot 1" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-04.jpg" aria-label="Open review 4">
    <img src="/picture/testimonial/tsm-04.jpg" alt="Guest testimonial screenshot 4" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-05.jpg" aria-label="Open review 5">
    <img src="/picture/testimonial/tsm-05.jpg" alt="Guest testimonial screenshot 5" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-06.jpg" aria-label="Open review 6">
    <img src="/picture/testimonial/tsm-06.jpg" alt="Guest testimonial screenshot 6" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-07.jpg" aria-label="Open review 7">
    <img src="/picture/testimonial/tsm-07.jpg" alt="Guest testimonial screenshot 7" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-08.jpg" aria-label="Open review 8">
    <img src="/picture/testimonial/tsm-08.jpg" alt="Guest testimonial screenshot 8" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-09.jpg" aria-label="Open review 9">
    <img src="/picture/testimonial/tsm-09.jpg" alt="Guest testimonial screenshot 9" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-10.jpg" aria-label="Open review 10">
    <img src="/picture/testimonial/tsm-10.jpg" alt="Guest testimonial screenshot 10" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-11.jpg" aria-label="Open review 11">
    <img src="/picture/testimonial/tsm-11.jpg" alt="Guest testimonial screenshot 11" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-12.jpg" aria-label="Open review 12">
    <img src="/picture/testimonial/tsm-12.jpg" alt="Guest testimonial screenshot 12" loading="lazy">
  </button>

  <button class="review-shot" type="button" data-review-src="/picture/testimonial/tsm-13.jpg" aria-label="Open review 13">
    <img src="/picture/testimonial/tsm-13.jpg" alt="Guest testimonial screenshot 13" loading="lazy">
  </button>

</div>


  <div class="review-proof__badges">
  <span class="review-badge">Read more Testimonials from past travelers</span>
    </div>
    
  </div>
</section>

<!-- Lightbox (đặt ngay sau section hoặc cuối body đều được) -->
<div class="review-lightbox" id="reviewLightbox" aria-hidden="true">
  <div class="review-lightbox__backdrop" data-review-close></div>

  <div class="review-lightbox__panel" role="dialog" aria-modal="true" aria-label="Review image viewer">
    <button class="review-lightbox__close" type="button" aria-label="Close" data-review-close>×</button>
    <img class="review-lightbox__img" alt="Guest review full view">
  </div>
</div>
  <!-- =========================================================
       (H) THREE COLUMNS SECTION (Conversion block)
       ========================================================= -->

  <!-- ✅ Three Columns Section -->
  <section class="three-columns py-4">
    <div class="container">
      <div class="row gy-5 gx-3 gx-md-5">

        <!-- Travel Blog -->
        <div class="col-md-4">
          <a href="/blog" class="overlay-card">
            <div
              class="overlay-card-bg"
              style="background-image: url('/picture/hanoi/hanoi.jpg');"
              aria-label="Hanoi Old Quarter street scene"
            ></div>
            <div class="overlay-gradient"></div>
            <div class="overlay-content">
              <h3 class="overlay-title">TRAVEL BLOG</h3>
              <p class="overlay-text">
                Our travel blog is jam-packed with wanderlust inspiration, the best things to do,
                insider tips and so much. More!
              </p>
              <span class="overlay-btn">Read More</span>
            </div>
          </a>
        </div>

        <!-- 5 start review -->
        <div class="col-md-4">
          <a href="https://www.tripadvisor.com/Attraction_Review-g293924-d32709948-Reviews-Photheculture-Hanoi.html" class="overlay-card">
            <div
              class="overlay-card-bg"
              style="background-image: url('/picture/ninhbinh/ninhbinh.jpg');"
              aria-label="Ninh Binh limestone mountains"
            ></div>

            <div class="overlay-gradient"></div>

            <div class="overlay-content">
              <h3 class="overlay-title">5-STAR REVIEWS</h3>
              <p class="overlay-text">
                We are proud of the over 1,000 outstanding reviews from our happy travelers.
              </p>
              <span class="overlay-btn">Read More</span>
            </div>
          </a>
        </div>

          <!-- Travel Advisor -->
          <div class="col-md-4">
            <a href="/experience" class="overlay-card">
              <div
                class="overlay-card-bg"
                style="background-image: url('/picture/sapa/sapa.jpg');"
                aria-label="Sapa terraced rice fields"
              ></div>
              <div class="overlay-gradient"></div>
              <div class="overlay-content">
                <h3 class="overlay-title">TRAVEL ADVISORS</h3>
                <p class="overlay-text">
                  Our extensive knowledge is rooted in our own travel experiences. Let us guide 
                  you as you plan your trip of a lifetime!
                </p>
                <span class="overlay-btn">Read More</span>
              </div>
            </a>
          </div>
        </div>

      </div>
</section>

  <!-- =========================================================
       (H) FINAL CTA
       ========================================================= -->
  <section class="py-5" style="background:#FFFCEE;color:#1C4278;">
    <div class="container text-center">
      <h2 style="font-family:'Roboto Slab', serif; font-weight:700;">Not sure what fits your days?</h2>
      <p style="max-width:760px;margin:10px auto 0;color:#555;">
        Tell us your dates and interests — we’ll recommend the best experiences across Hanoi, Sapa, and Ninh Binh.
      </p>

      <div class="mt-4">
        <a
          href="javascript:void(0)"
          class="explore-btn"
          data-cal-link="phothesense/quick-chat"
          data-cal-namespace="quick-chat"
          data-cal-config='{"layout":"month_view"}'
        >
          TALK TO A LOCAL EXPERT
        </a>
      </div>
    </div>
  </section>

</main>


    <button id="scrollToTop" class="scroll-to-top">
      <i class="fa-solid fa-chevron-up"></i>
    </button>

<script>
  // Hàm tổng hợp khởi tạo
  function initAll() {
    initHeroHeaderScroll();
    initOurPeopleHome();
    initReviewWallLightbox();
  }

  // 1. UI EFFECTS (Scroll, Hide Header)
  function initHeroHeaderScroll(): void {
    const heroHeader = document.querySelector('.hero-header') as HTMLElement | null;
    if (!heroHeader) return;
    
    const THRESHOLD = 60;
    window.addEventListener('scroll', () => {
      heroHeader.classList.toggle('scrolled', window.scrollY > THRESHOLD);
    }, { passive: true });
  }

  // 2. OUR PEOPLE HOME INTERACTION
  function initOurPeopleHome(): void {
    const root = document.querySelector('.our-people__list');
    if (!root) return;

    // Ép kiểu về HTMLElement để sử dụng được .dataset
    const groups = Array.from(document.querySelectorAll('.our-people__group')) as HTMLElement[];
    const images = Array.from(document.querySelectorAll('.our-people__img')) as HTMLElement[];

    const desktopName = document.getElementById('ourPeopleName');
    const desktopRole = document.getElementById('ourPeopleRole');
    const desktopBio = document.getElementById('ourPeopleBio');
    const desktopPanel = document.getElementById('our-people');

    const updateDesktopPanel = (group: HTMLElement) => {
      const meta = group.querySelector('.bio-meta')?.textContent;
      const name = group.querySelector('.bio-name')?.textContent;
      const desc = group.querySelector('.bio-desc')?.textContent;

      if (desktopRole) desktopRole.textContent = meta || '';
      if (desktopName) desktopName.textContent = name || '';
      if (desktopBio) desktopBio.textContent = desc || '';
      if (desktopPanel) desktopPanel.classList.add('is-bio-open');
    };

    const handleGroupClick = (clickedGroup: HTMLElement) => {
      const personId = clickedGroup.dataset.person;
      const isAlreadyActive = clickedGroup.classList.contains('is-active');

      // Đóng tất cả các mục
      groups.forEach(g => g.classList.remove('is-active'));

      if (!isAlreadyActive) {
        clickedGroup.classList.add('is-active');

        // Cập nhật ảnh tương ứng
        images.forEach(img => img.classList.remove('is-active'));
        const targetImg = images.find(img => img.dataset.person === personId);
        if (targetImg) targetImg.classList.add('is-active');

        updateDesktopPanel(clickedGroup);
      }
    };

    groups.forEach(group => {
      const btn = group.querySelector('.our-people__item');
      if (btn) {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          handleGroupClick(group);
        });
      }
    });

    // Khởi tạo trạng thái ban đầu cho người thứ nhất
    if (groups.length > 0) {
      const firstGroup = groups[0];
      updateDesktopPanel(firstGroup);
      const firstImg = images.find(img => img.dataset.person === firstGroup.dataset.person);
      if (firstImg) firstImg.classList.add('is-active');
    }
  }

  // 3. REVIEW WALL LIGHTBOX
  function initReviewWallLightbox(): void {
    const lb = document.getElementById('reviewLightbox');
    const wall = document.querySelector('.review-wall');
    if (!lb || !wall) return;

    const lbImg = lb.querySelector('.review-lightbox__img') as HTMLImageElement | null;

    wall.addEventListener('click', (e: Event) => {
      // Sửa lỗi e.target.closest
      const target = e.target as HTMLElement;
      const btn = target.closest('.review-shot') as HTMLElement | null;
      
      if (!btn || !lbImg) return;

      const img = btn.querySelector('img') as HTMLImageElement | null;
      if (img) {
        // Ưu tiên data-review-src, nếu không có thì lấy src của ảnh con
        lbImg.src = btn.dataset.reviewSrc || img.src;
        lb.classList.add('is-open');
        lb.setAttribute('aria-hidden', 'false');
      }
    });

    // Đóng Lightbox
    lb.querySelectorAll('[data-review-close]').forEach(el => {
      el.addEventListener('click', () => {
        lb.classList.remove('is-open');
        lb.setAttribute('aria-hidden', 'true');
      });
    });
  }

  // Lắng nghe sự kiện tải trang của Astro
  document.addEventListener('astro:page-load', initAll);

  // Chạy lần đầu nếu không dùng ViewTransitions
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initAll);
  } else {
    initAll();
  }
</script>

</Layout>
